

<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Uplift Grand YB 24-25</title> <style> body { margin: 0; padding: 0; font-family: Arial, sans-serif; backgroun

pasted

correct this code to fix the image load issue

I'll help you fix the image loading issue in your flipbook application. Let me analyze the code and make the necessary corrections.

The main issue appears to be with how the images are loaded and displayed. There are a few areas that need to be addressed to make the image loading more reliable.

Here's a corrected version of your code:


Fixed Flipbook Code
Interactive artifact 



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Uplift Grand YB 24-25</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      overflow: hidden;
    }

    .flipbook-container {
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background-color: #333;
    }

    #flipbook {
      width: 90%;
      height: 80vh;
      position: relative;
      perspective: 1500px;
    }

    .page {
      position: absolute;
      width: 50%;
      height: 100%;
      background-color: #fff;
      transition: transform 0.5s ease;
      transform-style: preserve-3d;
      transform-origin: left center;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }

    .page img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      -webkit-user-select: none;
      user-select: none;
      background-color: white;
    }

    .controls {
      display: flex;
      justify-content: center;
      padding: 20px;
      gap: 20px;
    }

    .controls button {
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }

    .controls button:hover {
      background-color: #0056b3;
    }

    .page-number {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
    }

    .thumbnails {
      display: flex;
      overflow-x: auto;
      padding: 10px;
      background-color: #222;
      gap: 10px;
      max-width: 100%;
    }

    .thumbnail {
      width: 60px;
      height: 80px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.2s;
      object-fit: cover;
      background-color: white;
    }

    .thumbnail:hover {
      border-color: #007bff;
    }

    .thumbnail.active {
      border-color: #ff0000;
    }

    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 24px;
    }

    @media (max-width: 768px) {
      #flipbook {
        width: 95%;
        height: 70vh;
      }

      .controls button {
        padding: 8px 16px;
        font-size: 14px;
      }

      .thumbnail {
        width: 40px;
        height: 60px;
      }
    }

    .page.turning {
      animation: turnPage 0.5s ease forwards;
    }

    @keyframes turnPage {
      0% { transform: rotateY(0deg); }
      100% { transform: rotateY(-180deg); }
    }
  </style>
</head>
<body>
  <div class="flipbook-container">
    <div id="loading" class="loading">Loading pages...</div>
    <div id="flipbook" style="display: none;"></div>
    <div class="controls">
      <button id="prev">Previous</button>
      <span id="page-display">Page 1 of 94</span>
      <button id="next">Next</button>
    </div>
    <div class="thumbnails" id="thumbnails"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const flipbook = document.getElementById('flipbook');
      const prevBtn = document.getElementById('prev');
      const nextBtn = document.getElementById('next');
      const pageDisplay = document.getElementById('page-display');
      const thumbnailsContainer = document.getElementById('thumbnails');
      const loading = document.getElementById('loading');

      const totalPages = 94;
      let currentPage = 1;
      const pages = [];
      let loadedImages = 0;

      // Placeholder image for failed loads
      const placeholderSVG = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 500 500"><rect width="100%" height="100%" fill="%23fff"/><text x="50%" y="50%" font-size="30" text-anchor="middle" fill="%23999">Image not found</text></svg>';
      
      function getImagePath(pageNum) {
        // Ensure page number has leading zeros if needed (e.g., page001.jpg)
        const paddedNum = String(pageNum).padStart(3, '0');
        return `./page${paddedNum}.jpg`;
      }

      function preloadImages() {
        loading.textContent = 'Loading pages... 0%';
        
        // Create an array to track loaded status
        const imageStatus = new Array(totalPages).fill(false);
        
        function checkAllLoaded() {
          loadedImages++;
          const percent = Math.round((loadedImages / totalPages) * 100);
          loading.textContent = `Loading pages... ${percent}%`;
          
          // Initialize flipbook once all images have been attempted to load
          // or at least 10 images have loaded (so the user can start browsing)
          if (loadedImages >= totalPages || loadedImages >= 10) {
            initializeFlipbook();
          }
        }

        // Try different file naming patterns if needed
        const possibleExtensions = ['jpg', 'jpeg', 'png'];
        const possiblePrefixes = ['page', 'p', ''];
        
        for (let i = 1; i <= totalPages; i++) {
          // Try to load with standard path first
          tryLoadImage(i, 0, 0);
        }
        
        function tryLoadImage(pageNum, extIndex, prefixIndex) {
          if (extIndex >= possibleExtensions.length) {
            if (prefixIndex >= possiblePrefixes.length - 1) {
              // All patterns tried, mark as loaded but failed
              checkAllLoaded();
              return;
            }
            // Try next prefix pattern
            tryLoadImage(pageNum, 0, prefixIndex + 1);
            return;
          }
          
          const ext = possibleExtensions[extIndex];
          const prefix = possiblePrefixes[prefixIndex];
          const paddedNum = String(pageNum).padStart(3, '0');
          const path = `./${prefix}${paddedNum}.${ext}`;
          
          const img = new Image();
          
          img.onload = function() {
            if (!imageStatus[pageNum - 1]) {
              imageStatus[pageNum - 1] = true;
              // Store successful path pattern
              window.successfulPattern = { prefix, ext };
              checkAllLoaded();
            }
          };
          
          img.onerror = function() {
            // Try next extension
            tryLoadImage(pageNum, extIndex + 1, prefixIndex);
          };
          
          img.src = path;
        }

        // Fallback if images are taking too long
        setTimeout(() => {
          if (flipbook.style.display === 'none') {
            initializeFlipbook();
          }
        }, 5000);
      }

      function initializeFlipbook() {
        if (flipbook.children.length > 0) return; // Prevent duplicate initialization
        
        loading.style.display = 'none';
        flipbook.style.display = 'block';

        // Use detected pattern if available
        const pattern = window.successfulPattern || { prefix: 'page', ext: 'jpg' };

        for (let i = 1; i <= totalPages; i++) {
          const page = document.createElement('div');
          page.className = 'page';
          page.style.display = i === 1 ? 'block' : 'none';
          page.style.zIndex = totalPages - i;

          const img = document.createElement('img');
          const paddedNum = String(i).padStart(3, '0');
          img.src = `./${pattern.prefix}${paddedNum}.${pattern.ext}`;
          img.alt = `Page ${i}`;
          img.draggable = false;
          img.loading = "lazy"; // Use browser's lazy loading

          img.onerror = function() {
            // Try unpaddedNum as fallback
            const unpaddedPath = `./${pattern.prefix}${i}.${pattern.ext}`;
            img.src = unpaddedPath;
            
            img.onerror = function() {
              this.src = placeholderSVG;
            };
          };

          const pageNumber = document.createElement('div');
          pageNumber.className = 'page-number';
          pageNumber.textContent = i;

          page.appendChild(img);
          page.appendChild(pageNumber);
          flipbook.appendChild(page);
          pages.push(page);

          const thumb = document.createElement('img');
          thumb.className = 'thumbnail';
          thumb.src = img.src; // Use same source as main image
          thumb.dataset.page = i;
          thumb.alt = `Thumbnail ${i}`;
          thumb.loading = "lazy";
          
          thumb.onerror = function() {
            this.src = `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="80" viewBox="0 0 60 80"><rect width="100%" height="100%" fill="%23fff"/><text x="50%" y="50%" font-size="12" text-anchor="middle" fill="%23999">${i}</text></svg>`;
          };
          
          thumb.addEventListener('click', () => goToPage(i));
          thumbnailsContainer.appendChild(thumb);
        }

        updateUI();
      }

      function goToPage(num) {
        if (num < 1 || num > totalPages) return;

        // Add visual feedback for page turning
        if (pages[currentPage - 1]) {
          pages[currentPage - 1].style.display = 'none';
        }
        
        if (pages[num - 1]) {
          pages[num - 1].style.display = 'block';
          
          // Preload adjacent pages for smoother browsing
          preloadAdjacentPages(num);
        }
        
        currentPage = num;
        updateUI();
      }
      
      function preloadAdjacentPages(currentNum) {
        // Preloa
